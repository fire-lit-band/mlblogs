# 离散随机变量

## 联合概率质量函数

两个离散随机变量 $X$ 和 $Y$ 的**联合概率质量函数**定义为：

$P_{XY}(x, y) = P(X = x, Y = y)$.

$\sum_{(x_i,y_j)\in R_{XY}} P_{XY}(x_i, y_j) = 1$

$P((X,Y) \in A) = \sum_{(x_i,y_j)\in (A \cap R_{XY})} P_{XY}(x_i, y_j)$

## 质量边际函数

$X$ 和 $Y$ 的边际概率质量函数（PMF）：

$P_X(x) = \sum_{y_j \in R_Y} P_{XY}(x, y_j)$, 对于任意 $x \in R_X$

$P_Y(y) = \sum_{x_i \in R_X} P_{XY}(x_i, y)$, 对于任意 $y \in R_Y$ (5.1)

## 联合累积函数

两个随机变量 $X$ 和 $Y$ 的**联合累积分布函数**定义为：

$F_{XY}(x, y) = P(X \le x, Y \le y)$.

## 边际累积分布函数

$X$ 和 $Y$ 的边际累积分布函数（CDFs）：

$F_X(x) = F_{XY}(x, \infty) = \lim_{y \to \infty} F_{XY}(x, y)$, 对于任意 $x$,
$F_Y(y) = F_{XY}(\infty, y) = \lim_{x \to \infty} F_{XY}(x, y)$, 对于任意 $y$ (5.2)

## 条件概率质量函数

对于一个离散随机变量 $X$ 和事件 $A$，给定 $A$ 的**条件概率质量函数（PMF）**定义为：

$P_{X|A}(x_i) = P(X = x_i|A) = \frac{P(X = x_i \text{ and } A)}{P(A)}$, 对于任意 $x_i \in R_X$.

类似地，我们定义给定 $A$ 的 $X$ 的**条件累积分布函数（CDF）**为：

$F_{X|A}(x) = P(X \le x|A)$.

对于离散随机变量 $X$ 和 $Y$，给定 $Y$ 的 $X$ 的**条件 PMF** 定义如下：

$P_{X|Y}(x_i|y_j) = \frac{P_{XY}(x_i, y_j)}{P_Y(y_j)}$,
$P_{Y|X}(y_j|x_i) = \frac{P_{XY}(x_i, y_j)}{P_X(x_i)}$

对于任意 $x_i \in R_X$ 和 $y_j \in R_Y$.

## 全概率定律

$P(X \in A) = \sum_{y_j \in R_Y} P(X \in A | Y = y_j)P_Y(y_j)$, 对于任意集合 $A$.

## 独立

两个离散随机变量 $X$ 和 $Y$ 是独立的，如果：

$P_{XY}(x,y) = P_X(x)P_Y(y)$, 对于所有 $x, y$.

等价地，$X$ 和 $Y$ 是独立的，如果：

$F_{XY}(x,y) = F_X(x)F_Y(y)$, 对于所有 $x, y$.

# 期望

$X$ 的条件期望：

$E[X|A] = \sum_{x_i \in R_X} x_i P_{X|A}(x_i)$,
$E[X|Y = y_j] = \sum_{x_i \in R_X} x_i P_{X|Y}(x_i|y_j)$

$E[g(X,Y)] = \sum_{(x_i,y_j)\in R_{XY}} g(x_i, y_j)P_{XY}(x_i, y_j)$ (5.5)

## 全期望定律

1.  如果 $B_1, B_2, B_3, \dots$ 是样本空间 $S$ 的一个划分，
    $EX = \sum_{i} E[X|B_i]P(B_i)$ (5.3)

2.  对于一个随机变量 $X$ 和一个离散随机变量 $Y$，
    $EX = \sum_{y_j \in R_Y} E[X|Y = y_j]P_Y(y_j)$ (5.4)

## 条件期望

$E[X|Y = y] = \sum_{x_i \in R_X} x_i P_{X|Y}(x_i|y)$.

可以看出来，这里条件期望的值由y决定，也就是$E[X|Y = y] $可以被看成是关于y的函数，也就是：$g(y)=E[X|Y = y]$，也就是

$g(Y)=E[X|Y]$

$E[g(X)h(Y)|X] = g(X)E[h(Y)|X]$

### law of iterated expectation

$E[X] = E[E[X|Y]]$

### 独立随机变量的期望

如果 $X$ 和 $Y$ 是独立随机变量，那么：

1.  E[XY]=EXEY
2.  $E[X|Y] = EX$;
3.  $E[g(X)|Y] = E[g(X)]$;
4.  $E[XY] = EXEY$;
5.  $E[g(X)h(Y)] = E[g(X)]E[h(Y)]$.

# 全方差定

$Var(X) = E[Var(X|Y)] + Var(E[X|Y])$ (5.10)

为了直观地描述全方差定律，通常查看一个被分成几个群体的人口是很有用的。特别是，假设我们有以下随机实验：我们随机选择世界上一个人，并查看他/她的身高。我们将结果值称为 $X$。定义另一个随机变量 $Y$，其值取决于所选人员的国家，其中 $Y = 1, 2, 3, \dots, n$，而 $n$ 是世界上国家的数量。然后，我们来看看全方差定律中的两个项。

请注意，$Var(X|Y = i)$ 是 $X$ 在国家 $i$ 中的方差。因此，$E(Var(X|Y))$ 是每个国家方差的平均值。另一方面，$E[X|Y = i]$ 是国家 $i$ 中的平均身高。因此，$Var(E[X|Y])$ 是国家之间的方差。所以，我们可以用以下方式解释全方差定律：$X$ 的方差可以分解为两部分：第一部分是每个国家中方差的平均值，而第二部分是每个国家平均身高之间的方差。

# 连续随机变量

如果存在一个非负函数 $f_{XY}: \mathbb{R}^2 \to \mathbb{R}$，使得对于任何集合 $A \in \mathbb{R}^2$，我们有：

$P((X,Y) \in A) = \iint_{A} f_{XY}(x,y)dxdy$ 

则称两个随机变量 $X$ 和 $Y$ 是**联合连续**的。

函数 $f_{XY}(x,y)$ 被称为 $X$ 和 $Y$ 的**联合概率密度函数（PDF）**。

$\int_{-\infty}^{\infty} \int_{-\infty}^{\infty} f_{XY}(x,y)dxdy = 1$

边际概率密度函数（PDFs）

$f_X(x) = \int_{-\infty}^{\infty} f_{XY}(x,y)dy$, 对于所有 $x$,
$f_Y(y) = \int_{-\infty}^{\infty} f_{XY}(x,y)dx$, 对于所有 $y$.

两个随机变量 $X$ 和 $Y$ 的**联合累积函数**定义为：

$F_{XY}(x,y) = P(X \le x, Y \le y)$.

联合 CDF 满足以下性质：

1.  $F_X(x) = F_{XY}(x, \infty)$, 对于任意 $x$ ($X$ 的边际 CDF);
2.  $F_Y(y) = F_{XY}(\infty, y)$, 对于任意 $y$ ($Y$ 的边际 CDF);
3.  $F_{XY}(\infty, \infty) = 1$;
4.  $F_{XY}(-\infty, y) = F_{XY}(x, -\infty) = 0$;
5.  $P(x_1 < X \le x_2, y_1 < Y \le y_2) = F_{XY}(x_2, y_2) - F_{XY}(x_1, y_2) - F_{XY}(x_2, y_1) + F_{XY}(x_1, y_1)$
6.  如果 $X$ 和 $Y$ 是独立的，那么 $F_{XY}(x,y) = F_X(x)F_Y(y)$.

两个连续随机变量 $X$ 和 $Y$ 是独立的，如果：

$f_{XY}(x,y) = f_X(x)f_Y(y)$, 对于所有 $x, y$.

等价地，$X$ 和 $Y$ 是独立的，如果：

$F_{XY}(x,y) = F_X(x)F_Y(y)$, 对于所有 $x, y$.

如果 $X$ 和 $Y$ 是独立的，我们有：

$E[XY] = EXEY$,
$E[g(X)h(Y)] = E[g(X)]E[h(Y)]$.

## 正态分布相加

如果 $X \sim N(\mu_X, \sigma_X^2)$ 且 $Y \sim N(\mu_Y, \sigma_Y^2)$ 是独立的，那么：

$X+Y \sim N(\mu_X + \mu_Y, \sigma_X^2 + \sigma_Y^2)$.

# 协方差

$X$ 和 $Y$ 之间的**协方差**定义为：

$Cov(X,Y) = E[(X - EX)(Y - EY)] = E[XY] - (EX)(EY)$.

**引理 5.3**
协方差具有以下性质：

1.  $Cov(X, X) = Var(X)$;
2.  如果 $X$ 和 $Y$ 独立，则 $Cov(X, Y) = 0$;
3.  $Cov(X, Y) = Cov(Y, X)$;
4.  $Cov(aX, Y) = aCov(X, Y)$;
5.  $Cov(X + c, Y) = Cov(X, Y)$;
6.  $Cov(X + Y, Z) = Cov(X, Z) + Cov(Y, Z)$;
7.  更一般地，

$Cov\left(\sum_{i=1}^{m} a_i X_i, \sum_{j=1}^{n} b_j Y_j\right) = \sum_{i=1}^{m} \sum_{j=1}^{n} a_i b_j Cov(X_i, Y_j)$.

$Var(aX + bY) = a^2Var(X) + b^2Var(Y) + 2abCov(X, Y)$

$\rho_{XY} = \rho(X,Y) = \frac{Cov(X,Y)}{\sqrt{Var(X)Var(Y)}} = \frac{Cov(X,Y)}{\sigma_X\sigma_Y}$

如果 $X$ 和 $Y$ 不相关，那么

$Var(X+Y) = Var(X) + Var(Y)$.

更一般地，如果 $X_1, X_2, \dots, X_n$ 是两两不相关的，即当 $i \ne j$ 时 $\rho(X_i, X_j) = 0$，那么

$Var(X_1 + X_2 + \dots + X_n) = Var(X_1) + Var(X_2) + \dots + Var(X_n)$.

# 联合正态分布

如果对于所有 $a, b \in \mathbb{R}$，$aX + bY$ 具有正态分布，则称两个随机变量 $X$ 和 $Y$ 是**二元正态**或**联合正态**的。

如果两个随机变量 $X$ 和 $Y$ 的联合 PDF 由以下公式给出，则称它们具有参数为 $\mu_X, \sigma_X^2, \mu_Y, \sigma_Y^2$ 和 $\rho$ 的**二元正态分布**：

$f_{XY}(x,y) = \frac{1}{2\pi\sigma_X\sigma_Y\sqrt{1-\rho^2}} \exp\left\{-\frac{1}{2(1-\rho^2)}\left[\left(\frac{x-\mu_X}{\sigma_X}\right)^2 + \left(\frac{y-\mu_Y}{\sigma_Y}\right)^2 - 2\rho\frac{(x-\mu_X)(y-\mu_Y)}{\sigma_X\sigma_Y}\right]\right\}$ 

其中 $\mu_X, \mu_Y \in \mathbb{R}$, $\sigma_X, \sigma_Y > 0$ 且 $\rho \in (-1,1)$ 都是常数。

$\begin{cases} X = \sigma_X Z_1 + \mu_X \\ Y = \sigma_Y (\rho Z_1 + \sqrt{1 - \rho^2} Z_2) + \mu_Y \end{cases}$

假设 $X$ 和 $Y$ 是联合正态随机变量，其参数为 $\mu_X, \sigma_X^2, \mu_Y, \sigma_Y^2$ 和 $\rho$。那么，给定 $X = x$， $Y$ 服从正态分布，其参数为：

$E[Y|X = x] = \mu_Y + \rho\sigma_Y \frac{x - \mu_X}{\sigma_X}$,
$Var(Y|X = x) = (1 - \rho^2)\sigma_Y^2$.

# 矩

随机变量 $X$ 的 $n$ 阶矩定义为 $E[X^n]$。$X$ 的 $n$ 阶中心矩定义为 $E[(X - EX)^n]$。

例如，一阶矩是期望值 $E[X]$。二阶中心矩是 $X$ 的方差。

## 矩生成函数

随机变量 $X$ 的矩生成函数（MGF）是一个函数 $M_X(s)$，定义为：

$M_X(s) = E[e^{sX}]$.

如果存在一个正常数 $a$，使得对于所有 $s \in [-a, a]$，$M_X(s)$ 是有限的，则称 $X$ 的 MGF 存在。

我们可以从 $X$ 的 MGF 中获取所有矩：

$M_X(s) = \sum_{k=0}^{\infty} E[X^k] \frac{s^k}{k!}$,
$E[X^k] = \frac{d^k}{ds^k}M_X(s)|_{s=0}$.

如果 $X_1, X_2, \dots, X_n$ 是 $n$ 个**独立**随机变量，那么

$M_{X_1+X_2+\dots+X_n}(s) = M_{X_1}(s)M_{X_2}(s)\dots M_{X_n}(s)$.

| 分布                          | 矩函数                 |
| ----------------------------- | ---------------------- |
| $X \sim Exponential(\lambda)$ | $\frac{k!}{\lambda^k}$ |
| $X\sim Poisson(\lambda)$      | $e^{\lambda (e^s-1)}$  |
| $X\sim Binomial(m,p)$         | $(pe^s+1-1)^n$         |

## 特征函数

$\phi_X(\omega) = E[e^{j\omega X}]$,

# 随机向量

$X=[X_1,\dots X_n]^T$

那么$EX=[X_1,\dots X_n]^T$

**相关和协方差矩阵**

对于一个随机向量 $\mathbf{X}$，我们定义**相关矩阵** $\mathbf{R_X}$ 为：

$\mathbf{R_X} = E[\mathbf{XX}^T] = E\begin{bmatrix} X_1^2 & X_1X_2 & \dots & X_1X_n \\ X_2X_1 & X_2^2 & \dots & X_2X_n \\ \vdots & \vdots & \ddots & \vdots \\ X_nX_1 & X_nX_2 & \dots & X_n^2 \end{bmatrix} = \begin{bmatrix} EX_1^2 & E[X_1X_2] & \dots & E[X_1X_n] \\ E[X_2X_1] & E[X_2^2] & \dots & E[X_2X_n] \\ \vdots & & \ddots & \vdots \\ E[X_nX_1] & E[X_nX_2] & \dots & E[X_n^2] \end{bmatrix}$,

其中 $T$ 表示矩阵转置。

**协方差矩阵** $C_X$ 定义为：

$C_X = E[(\mathbf{X} - E\mathbf{X})(\mathbf{X} - E\mathbf{X})^T]$

$= E\begin{bmatrix} (X_1 - EX_1)^2 & (X_1 - EX_1)(X_2 - EX_2) & \dots & (X_1 - EX_1)(X_n - EX_n) \\ (X_2 - EX_2)(X_1 - EX_1) & (X_2 - EX_2)^2 & \dots & (X_2 - EX_2)(X_n - EX_n) \\ \vdots & \vdots & \ddots & \vdots \\ (X_n - EX_n)(X_1 - EX_1) & (X_n - EX_n)(X_2 - EX_2) & \dots & (X_n - EX_n)^2 \end{bmatrix}$

$= \begin{bmatrix} Var(X_1) & Cov(X_1, X_2) & \dots & Cov(X_1, X_n) \\ Cov(X_2, X_1) & Var(X_2) & \dots & Cov(X_2, X_n) \\ \vdots & \vdots & \ddots & \vdots \\ Cov(X_n, X_1) & Cov(X_n, X_2) & \dots & Var(X_n) \end{bmatrix}$

$X$ 的相关矩阵：
$\mathbf{R_X} = E[\mathbf{XX}^T]$

$X$ 的协方差矩阵：
$C_X = E[(\mathbf{X} - E\mathbf{X})(\mathbf{X} - E\mathbf{X})^T] = \mathbf{R_X} - E\mathbf{X}E\mathbf{X}^T$

协方差矩阵 $C_\mathbf{X}$ 是正半定（PSD）的。

最后，如果我们有两个随机向量 $\mathbf{X}$ 和 $\mathbf{Y}$，我们可以定义 $\mathbf{X}$ 和 $\mathbf{Y}$ 的**互相关矩阵**为：

$\mathbf{R_{XY}} = E[\mathbf{XY}^T]$.

此外，$\mathbf{X}$ 和 $\mathbf{Y}$ 的**互协方差矩阵**是：

$C_{XY} = E[(\mathbf{X} - E\mathbf{X})(\mathbf{Y} - E\mathbf{Y})^T]$.

假设随机向量 $\mathbf{Y}$ 由 $\mathbf{Y} = G(\mathbf{X})$ 给出，因此 $\mathbf{X} = G^{-1}(\mathbf{Y}) = H(\mathbf{Y})$。也就是说，

$\mathbf{X} = \begin{bmatrix} X_1 \\ X_2 \\ \vdots \\ X_n \end{bmatrix} = \begin{bmatrix} H_1(Y_1,Y_2,\dots,Y_n) \\ H_2(Y_1,Y_2,\dots,Y_n) \\ \vdots \\ H_n(Y_1,Y_2,\dots,Y_n) \end{bmatrix}$.

那么，$\mathbf{Y}$ 的 PDF，$f_{Y_1,Y_2,\dots,Y_n}(y_1,y_2,\dots,y_n)$，由下式给出：

$f_\mathbf{Y}(\mathbf{y}) = f_\mathbf{X}(H(\mathbf{y}))|J|$

其中 $J$ 是 $H$ 的雅可比行列式，定义为：

$J = \det \begin{bmatrix} \frac{\partial H_1}{\partial y_1} & \frac{\partial H_1}{\partial y_2} & \dots & \frac{\partial H_1}{\partial y_n} \\ \frac{\partial H_2}{\partial y_1} & \frac{\partial H_2}{\partial y_2} & \dots & \frac{\partial H_2}{\partial y_n} \\ \vdots & \vdots & \ddots & \vdots \\ \frac{\partial H_n}{\partial y_1} & \frac{\partial H_n}{\partial y_2} & \dots & \frac{\partial H_n}{\partial y_n} \end{bmatrix}$

一个随机向量$\mathbf{X} =[X_1 X_2  \dots  X_n ]^T$

如果随机变量 $X_1, X_2, \dots, X_n$ 是联合正态的，则称其为**正态**或**高斯**。

对于一个标准正态随机向量 $\mathbf{Z}$，其中 $Z_i$'s 是 i.i.d. 且 $Z_i \sim N(0,1)$，其 PDF 由下式给出：

$f_\mathbf{Z}(\mathbf{z}) = \frac{1}{(2\pi)^{\frac{n}{2}}} \exp\left\{-\frac{1}{2}\mathbf{z}^T \mathbf{z}\right\}$.

对于一个均值为 $\mathbf{m}$ 且协方差矩阵为 $\mathbf{C}$ 的正态随机向量 $\mathbf{X}$，其 PDF 由下式给出：

$f_\mathbf{X}(\mathbf{x}) = \frac{1}{(2\pi)^{\frac{n}{2}} \sqrt{\det \mathbf{C}}} \exp\left\{-\frac{1}{2}(\mathbf{x} - \mathbf{m})^T \mathbf{C}^{-1}(\mathbf{x} - \mathbf{m})\right\}$ (6.1)

如果 $\mathbf{X} = [X_1, X_2, \dots, X_n]^T$ 是一个正态随机向量，并且我们知道当 $i \ne j$ 时 $Cov(X_i, X_j) = 0$，那么 $X_1, X_2, \dots, X_n$ 是独立的。

另一个重要结果是，如果 $\mathbf{X} = [X_1, X_2, \dots, X_n]^T$ 是一个正态随机向量，那么 $\mathbf{Y} = \mathbf{AX} + \mathbf{b}$ 也是一个随机向量，因为 $\mathbf{Y}$ 的分量的任何线性组合都是 $\mathbf{X}$ 的分量的线性组合加上一个常数值。

如果 $\mathbf{X} = [X_1, X_2, \dots, X_n]^T$ 是一个正态随机向量，$X \sim N(\mathbf{m}, \mathbf{C})$，$A$ 是一个 $m \times n$ 的固定矩阵，$\mathbf{b}$ 是一个 $m$ 维的固定向量，那么随机向量 $\mathbf{Y} = \mathbf{AX} + \mathbf{b}$ 是一个均值为 $E\mathbf{AX} + \mathbf{b}$ 且协方差矩阵为 $A\mathbf{CA}^T$ 的正态随机向量。

$\mathbf{Y} \sim N(E\mathbf{AX} + \mathbf{b}, A\mathbf{CA}^T)$